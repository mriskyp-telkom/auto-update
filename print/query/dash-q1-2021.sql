select 'Non Buku' as jenis,cast(ifnull(sum(rp.jumlah),0) as numeric(18,0))as total from rapbs r join rapbs_periode rp on r.id_rapbs = rp.id_rapbs join (select ax.* from anggaran ax join (select id_ref_sumber_dana,max(is_revisi) as is_revisi from anggaran where soft_delete=0 group by id_ref_sumber_dana) ax2 on ax.id_ref_sumber_dana = ax2.id_ref_sumber_dana and ax.is_revisi = ax2.is_revisi) a on r.id_anggaran = a.id_anggaran join ref_kode rk on r.id_ref_kode = rk.id_ref_kode where rk.id_kode not in ('03.02.04.','03.02.16.','05.02.09.','05.02.10.','05.02.12.','05.02.15.') and r.soft_delete=0 and a.soft_delete=0 and rp.soft_delete=0 and (r.keterangan <> 'sisa' or keterangan is null) and a.id_ref_sumber_dana=:id_sumber_dana 
union
select 'Buku' as jenis,cast(ifnull(sum(rp.jumlah),0) as numeric(18,0))as total from rapbs r join rapbs_periode rp on r.id_rapbs = rp.id_rapbs join (select ax.* from anggaran ax join (select id_ref_sumber_dana,max(is_revisi) as is_revisi from anggaran where soft_delete=0 group by id_ref_sumber_dana) ax2 on ax.id_ref_sumber_dana = ax2.id_ref_sumber_dana and ax.is_revisi = ax2.is_revisi) a on r.id_anggaran = a.id_anggaran join ref_kode rk on r.id_ref_kode = rk.id_ref_kode where rk.id_kode in ('03.02.04.','03.02.16.','05.02.09.','05.02.10.','05.02.12.','05.02.15.')  and r.soft_delete=0 and a.soft_delete=0 and rp.soft_delete=0 and (r.keterangan <> 'sisa' or keterangan is null) and a.id_ref_sumber_dana=:id_sumber_dana
